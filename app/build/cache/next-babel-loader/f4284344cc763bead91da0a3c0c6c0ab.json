{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/esm/asyncToGenerator\"));\n\nvar _tokenService = _interopRequireDefault(require(\"../services/token-service\"));\n\nvar agent = require(\"./agent\");\n\nfunction registerAccount(_x) {\n  return _registerAccount.apply(this, arguments);\n}\n\nfunction _registerAccount() {\n  _registerAccount = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee(user) {\n    return _regenerator[\"default\"].wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            return _context.abrupt(\"return\", agent.get().post(\"/api/user/register\", {\n              user: user\n            }).then(function (resp) {\n              return resp.data;\n            }));\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _registerAccount.apply(this, arguments);\n}\n\nfunction login(_x2) {\n  return _login.apply(this, arguments);\n}\n\nfunction _login() {\n  _login = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee2(user) {\n    return _regenerator[\"default\"].wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            return _context2.abrupt(\"return\", agent.get().post(\"/api/user/login\", {\n              user: user\n            }).then(function (resp) {\n              return resp.data;\n            }));\n\n          case 1:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _login.apply(this, arguments);\n}\n\nfunction postRefreshToken() {\n  return _postRefreshToken.apply(this, arguments);\n}\n\nfunction _postRefreshToken() {\n  _postRefreshToken = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee4() {\n    var _this = this;\n\n    var respJson;\n    return _regenerator[\"default\"].wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.next = 2;\n            return agent.get().post(\"/api/user/refresh\").then(function (resp) {\n              return resp.data;\n            });\n\n          case 2:\n            respJson = _context4.sent;\n\n            _tokenService[\"default\"].saveAuthToken(respJson.authToken);\n\n            _tokenService[\"default\"].queueCallbackBeforeExpiry( /*#__PURE__*/(0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee3() {\n              return _regenerator[\"default\"].wrap(function _callee3$(_context3) {\n                while (1) {\n                  switch (_context3.prev = _context3.next) {\n                    case 0:\n                      _context3.next = 2;\n                      return _this.postRefreshToken();\n\n                    case 2:\n                    case \"end\":\n                      return _context3.stop();\n                  }\n                }\n              }, _callee3);\n            })));\n\n            return _context4.abrupt(\"return\", respJson);\n\n          case 6:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n  return _postRefreshToken.apply(this, arguments);\n}\n\nmodule.exports = {\n  registerAccount: registerAccount,\n  login: login,\n  postRefreshToken: postRefreshToken\n};","map":null,"metadata":{},"sourceType":"script"}